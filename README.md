# Дипломная работа к профессии Python-разработчик «API Сервис заказа товаров для розничных сетей».

Перед запуском заполнить и переименовать файл .env.dev в .env 

Используется приложение данное в задании

Запуск с помощью `docker compose up --build`

Пять контейнеров база данных `PostgreSQL`, `Redis`, `Celery`, приложение `Shops` и тесты  

Приложение смотрит на `0.0.0.0:8001`

 ## Добавлено в проект
- В модели User используется повтор пароля и дополнительное поле "Отчество"
- настроен стандартная админка Django
- Дополнил `APIView Storage`, в котором реализована админка специалиста склада, при отправке заказа меняется количество товара на складе
- Добавлено использование асинхронной работы для долгих процессов отправка сообщений. Реализованно две таски `send_email` и `get_price`. Запущен `Celery`.
- Приложение запускается через `gunicorn` для продакшна.
- Можно в `run.sh` поменять на локальный запуск
- Сообщения сейчас приходят в консоль, но можно раскомментировать рабочий вариант

## Доработка проекта
- Я понимаю, что `ViewSet` более перспективны с точки зрения реализации CRUD сразу под капотом, но в моем случае для реального применения `ViewSet` нужно менять логику реализации. Поэтому , чтобы это не менять в учебных целях выделил  `ViewSet`  в отдельную реализацию, а именно реализован `BasketViewSet` в отдельном файле `view_viewset.py`.
- Также подключил этот  viewset через роутер `SimpleRouter` в модуле `url_basket_viewset.py`.
- Тесты этого  viewset выделены в отдельный файл `test_basket_viewset.py`.
- C точки зрения уменьшения количества кода у меня не получилось, т к я не менял первичную логику запросов, поэтому все методы остались кастомными, но я прописал дополнительные методы get для сериалайзеров и queryset.
- C моей точки зрения, как мин на данном этапе моего развития)) мне нужно отдавать предпочтение легкости прочтения моего кода, чем уменьшению количества строк.
- Добавил простой тротлинг на базе `DEFAULT_THROTTLE_CLASSES`.
- Сделал авторизацию через `account google и github` с помощью библиотеки `django-allauth`.



## Вопросы , которые не смог решить( по ним нужна помощь в исполнении)
- не понимаю, как протестировавать partner-update, при подключенном Celery, вместо тестовой базы идет запрос в рабочую, естественно тесты падают
- ~~не доработан Swagger, сам он подключен, autoschema работает при выключенном `viewset_router`. Когда подключаешь дополнительный роутер `viewset_router` autoschema падает, как исправить это не понимаю, нужно хотя бы направление где это искать~~  Заменил `drf_yasg` на `drf_spectacular`  и схема для Swagger заработала и с `viewset`
- не знаю как запустить Celery в режиме DEBUG = False. На это выдается предупреждение, никак не могу подобрать вариант, чтобы предупреждение не выдавалось. Хотя запуск происходит в режите `DEBUG=False`